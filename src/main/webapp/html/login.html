<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <link rel="apple-touch-icon" sizes="76x76" href="../img/favicon.ico">

  <title>LOGIN</title>

  <script src="../js/jquery-2.2.4.min2.js" type="text/javascript"></script>
  <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport'/>
  <meta name="viewport" content="width=device-width"/>

  <link rel="apple-touch-icon" sizes="76x76" href="../img/apple-icon.png"/>
  <link rel="icon" type="image/png" href="../img/favicon.png"/>

  <!--     Fonts and icons     -->
  <link rel="stylesheet" type="text/css" href="../css/materialIcons2.css"/>
  <link rel="stylesheet" href="../css/font-awesome.min2.css"/>

  <!-- CSS Files -->
  <link href="../css/bootstrap.min2.css" rel="stylesheet"/>
  <link href="../css/material-bootstrap-wizard2.css" rel="stylesheet"/>

  <!-- CSS Just for demo purpose, don't include it in your project -->
  <link href="../css/demo2.css" rel="stylesheet"/>

  <!--<link rel="stylesheet" href="../js/jquery-3.3.1.min.js">-->
</head>

<body>
<div class="image-container set-full-height" style="background-image: url('../img/wizard-profile.jpg')">
  <!--   Big container   -->
  <div class="container">
    <div class="row">
      <div class="col-sm-6 col-sm-offset-3">
        <!--      Wizard container        -->
        <div class="wizard-container">
          <div class="card wizard-card" data-color="green" id="wizardProfile">

            <form action="" id="form">
              <!--        You can switch " data-color="purple" "  with one of the next bright colors: "green", "orange", "red", "blue"       -->

              <div class="wizard-header">
                <h2 class="wizard-title">千寻</h2>
                <h5>LIFE IS TO SEEK NEW KNOWLEDGE!</h5>
              </div>
              <div class="wizard-navigation">
                <ul>
                  <li>
                    <a href="#login" data-toggle="tab">登录</a>
                  </li>
                  <li>
                    <a href="#register" data-toggle="tab">注册</a>
                  </li>

                  <li>
                    <a href="#phone" data-toggle="tab">手机</a>
                  </li>
                </ul>
              </div>

              <div class="tab-content">
                <div class="tab-pane" id="login">
                  <div class="row">
                    <div class="col-sm-10 col-sm-offset-1">
                      <div class="input-group">
                          <span class="input-group-addon">
                            <!--<i class="material-icons">face</i>-->
                            <img src="../img/account.svg" width="24" height="24" alt="密码">
                          </span>
                        <div class="form-group label-floating">
                          <label class="control-label">账号
                          </label>
                          <input name="userName" id="userName" type="text" class="form-control" onkeyup="checkLogin()">
                        </div>
                      </div>

                      <div class="input-group">
                          <span class="input-group-addon">
                            <!--<i class="material-icons">record_voice_over</i>-->
                            <img src="../img/password.svg" width="24" height="24" alt="密码">
                          </span>
                        <div class="form-group label-floating">
                          <label class="control-label">密码
                          </label>
                          <input name="userPassword" id="userPassword" type="password" class="form-control"
                                 onkeyup="checkLogin()">
                        </div>
                      </div>

                      <div class="input-group">
                        <a href="">忘记密码？</a>
                      </div>

                    </div>
                  </div>
                </div>

                <div class="tab-pane" id="register">
                  <div class="row">

                    <div class="col-sm-10 col-sm-offset-1">
                      <div class="input-group">
                          <span class="input-group-addon">
                            <!--<i class="material-icons">face</i>-->
                            <img src="../img/account.svg" width="24" height="24" alt="密码">
                          </span>
                        <div class="form-group label-floating">
                          <label class="control-label">账号
                          </label>
                          <input name="account" id="account" type="text" class="form-control" onkeyup="checkAccount()">
                        </div>
                      </div>

                      <div class="input-group">
                          <span class="input-group-addon">
                            <!--<i class="material-icons">record_voice_over</i>-->
                            <img src="../img/password.svg" width="24" height="24" alt="密码">
                          </span>
                        <div class="form-group label-floating">
                          <label class="control-label">密码
                          </label>
                          <input name="password" id="pwd" type="password" class="form-control">
                        </div>
                      </div>

                      <div class="input-group">
                          <span class="input-group-addon">
                            <!--<i class="material-icons">record_voice_over</i>-->
                            <img src="../img/password.svg" width="24" height="24" alt="密码">
                          </span>
                        <div class="form-group label-floating">
                          <label class="control-label">确认密码
                          </label>
                          <input name="rePassword" id="rpwd" type="password" class="form-control" onkeyup="check()">
                        </div>
                      </div>
                    </div>

                  </div>
                </div>

                <div class="tab-pane" id="phone">
                  <div class="row">
                    <div class="col-sm-10 col-sm-offset-1">
                      <div class="input-group">
                          <span class="input-group-addon">
                            <!--<i class="material-icons">face</i>-->
                            <img src="../img/account.svg" width="24" height="24" alt="密码">
                          </span>
                        <div class="form-group label-floating">
                          <label class="control-label">手机号
                          </label>
                          <input name="userPhone" id="userPhone" type="text" class="form-control"
                                 onkeyup="checkUserPhone()">
                        </div>
                      </div>
                      <div class="input-group">
                        <span class="input-group-addon">
                            <!--<i class="material-icons">face</i>-->
                          <!--<img src="../img/account.svg" width="24" height="24" alt="密码">-->
                        </span>
                        <button type="button" class="btn btn-success" onclick="sendCode()"
                                style="width: 100%;height: 35px;">获取验证码
                        </button>
                      </div>

                      <div class="input-group">
                          <span class="input-group-addon">
                            <!--<i class="material-icons">record_voice_over</i>-->
                            <img src="../img/password.svg" width="24" height="24" alt="验证码">
                          </span>
                        <div class="form-group label-floating">
                          <label class="control-label">验证码
                          </label>
                          <input name="authCode" id="authCode" type="text" class="form-control"
                                 onkeyup="checkUserPhone()">
                        </div>
                      </div>

                    </div>
                  </div>
                </div>

              </div>
              <div class="wizard-footer">
                <div class="pull-right">

                  <!--<input type='button' class='btn btn-finish btn-fill btn-success btn-wd' name='finish' value='Finish' />-->
                  <input type='button' class='btn btn-fill btn-success btn-login btn-wd' id="log"
                         onclick='userLogin()'
                         name='login' value='登录'/>
                  <input type="button" class="btn btn-fill btn-success btn-reg btn-wd" id="reg" onclick="registerUser()"
                         name="register" value="注册"/>
                  <input type="button" class="btn btn-fill btn-success btn-pReg btn-wd" id="pReg"
                         onclick="pRegisterUser()"
                         name="register" value="手机注册"/>

                </div>

                <div class="pull-left">
                  <input type='button' class='btn btn-fill btn-default bt-reg btn-wd' name='reset' value='重置'/>
                  <span id="info-pwd"></span>
                  <!--<input type='button' class='btn btn-previous btn-fill btn-default btn-wd' name='previous' value='Previous' />-->
                </div>
                <div class="clearfix"></div>
              </div>
            </form>
          </div>
        </div>
        <!-- wizard container -->
      </div>
    </div>
    <!-- end row -->
  </div>
  <!--  big container -->

  <div class="footer">
    <div class="container text-center">

    </div>
  </div>
</div>

</body>
<script>
    $("#log").attr("disabled", true);
    $("#reg").attr("disabled", true);
    $("#pReg").attr("disabled", true);

    function userLogin() {
        console.log($("#form").serialize());
        var userName = $("userName").val();
        var userPassword = $("userPassword").val();
        console.log(userName, userPassword);
        $.ajax({
            url: "/users/login",
            type: "post",
            async: false,
            data: $("#form").serialize(),
            success: function (data) {
                if (data.msg === "true") {
                    window.location.href = "/html/index.html";
                } else {
                    alert("密码错误，重新登录");
                }
            }
        })
    }

    function registerUser() {
        console.log($("#form").serialize());
        $.ajax({
            url: "/users/register",
            type: "post",
            async: false,
            data: $("#form").serialize(),
            success: function (data) {
                if (data.msg == "true") {
                    alert("注册成功，即将跳转主页");
                    window.location.href = "/html/index.html";
                } else {
                    alert(data.msg);
                }
            }
        })
    }

    function sendCode() {
        var userPhone = $("#userPhone").val();
        $.ajax({
            url: "/users/getAuthCode",
            type: "post",
            async: false,
            data: {"userPhone": userPhone},
            success: function (data) {
                alert(data.msg);
            }
        })
    }

    //手机注册
    function pRegisterUser() {
        var userPhone = $("#userPhone").val();
        var authCode = $("#authCode").val();
        console.log($("#form").serialize());
        $.ajax({
            url: "/users/pRegister",
            type: "post",
            async: false,
            data: {"userPhone": userPhone, "authCode": authCode},
            success: function (data) {
                if (data.msg === "true") {
                    alert("默认密码为验证码,注册成功，即将跳转主页");
                    window.location.href = "/html/index.html";
                } else {
                    alert(data.msg);
                }
            }
        })
    }

    //手机号验证
    function isPhoneNum(str) {
        return /^(0|86|17951)?(13[0-9]|15[012356789]|17[3678]|18[0-9]|14[57])[0-9]{8}$/.test(str)
    }

    //手机号验证
    function checkUserPhone() {
        var userPhone = $("#userPhone").val();
        if (isPhoneNum(userPhone)) {
            $("#info-pwd").text("");
            var authCode = $("#authCode").val();
            if (authCode.length !== 6) {
                $("#info-pwd").text("验证码长度错误");
                $("#pReg").attr("disabled", true);
            } else {
                $("#pReg").attr("disabled", false);
            }
        } else {
            $("#info-pwd").text("请输入正确的手机号");
            $("#pReg").attr("disabled", true);
        }
    }

    //检查登录框
    function checkLogin() {
        var userName = $("#userName").val();
        var userPassword = $("#userPassword").val();
        console.log(userName, userPassword);
        if (userName != "" && userPassword != "") {
            $("#info-pwd").text("");
            $("#log").attr("disabled", false);
        } else {
            $("#info-pwd").text("输入不可为空");
            $("#log").attr("disabled", true);
        }
    }

    //
    function checkAccount() {
        var acc = $("#account").val();
        if (acc === "") {
            $("#info-pwd").text("用户名不可为空");
            $("#reg").attr("disabled", true);
        }
        else {
            $("#info-pwd").text("");
        }
    }

    //注册界面
    function check() {

        var npwd = $("#pwd").val();
        var rnpwd = $("#rpwd").val();

        if (npwd == "") {
            $("#info-pwd").text("输入密码不可为空");
            $("#reg").attr("disabled", true);
        }
        else {
            if (npwd != rnpwd) {
                $("#info-pwd").text("输入密码不相同");
                $("#reg").attr("disabled", true);
            } else {
                $("#info-pwd").text("");
                $("#reg").attr("disabled", false);
            }
        }


    }


</script>

<!--   Core JS Files   -->
<script src="../js/jquery-2.2.4.min2.js" type="text/javascript"></script>
<script src="../js/bootstrap.min2.js" type="text/javascript"></script>
<script src="../js/jquery.bootstrap2.js" type="text/javascript"></script>

<!--  Plugin for the Wizard -->
<script src="../js/material-bootstrap-wizard2.js"></script>

<!--  More information about jquery.validate here: http://jqueryvalidation.org/	 -->
<script src="../js/jquery.validate.min2.js"></script>

</html>
